<!doctype html>
<html lang="hi">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Movie with Interstitial Ad</title>
  <style>
    body { font-family: Arial, sans-serif; margin:0; padding:20px; background:#f7f7f7; }
    .movie-btn { display:inline-block; padding:12px 18px; background:#1f8ef1; color:#fff; text-decoration:none; border-radius:6px; cursor:pointer; }
    .overlay {
      position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
      background:rgba(0,0,0,0.75); z-index:9999; visibility:hidden; opacity:0; transition:opacity .2s;
    }
    .overlay.show { visibility:visible; opacity:1; }
    .ad-box {
      width:90%; max-width:900px; background:#fff; border-radius:8px; padding:12px; box-shadow:0 10px 30px rgba(0,0,0,0.4);
      position:relative;
    }
    .ad-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; }
    .ad-title { font-weight:700; }
    .close-btn, .open-ad-tab-btn {
      border:0; padding:8px 12px; border-radius:6px; cursor:pointer; font-weight:600;
    }
    .close-btn[disabled] { opacity:.5; cursor:not-allowed; }
    .ad-frame { min-height:250px; display:flex; align-items:center; justify-content:center; }
    .small-note { font-size:13px; color:#444; margin-top:8px; text-align:center; }
  </style>
</head>
<body>

  <h2>Movie: Click below to watch</h2>
  <p>Agar aap movie dekhna chahte ho to button dabao — pehle ek ad popup aayega. Close karne par movie Google Drive pe khulega.</p>

  <!-- Movie link trigger -->
  <button id="playBtn" class="movie-btn">Play Movie</button>

  <!-- Overlay / Interstitial -->
  <div id="interstitial" class="overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="ad-box" role="document">
      <div class="ad-header">
        <div class="ad-title">Sponsored</div>
        <div>
          <!-- Optionally open the ad in a new tab (user action). Useful for mobile where ad networks prefer visible user navigation. -->
          <button id="openAdTab" class="open-ad-tab-btn" title="Open ad in a new tab (optional)">Open Ad in new tab</button>
          &nbsp;
          <button id="closeAd" class="close-btn" disabled>Close ad (<span id="countdown">5</span>s)</button>
        </div>
      </div>

      <!-- Ad container: Adsterra script included here -->
      <div id="ad-container" class="ad-frame">
        <!-- Adsterra script (user-provided). Keep exactly as provided by ad network. -->
        <script async="async" data-cfasync="false" src="//pl27073688.effectivegatecpm.com/03a29260fe0435d3922b726bb7da0b06/invoke.js"></script>
        <div id="container-03a29260fe0435d3922b726bb7da0b06"></div>
      </div>

      <div class="small-note">
        Ad will be visible for a few seconds. You can optionally open it in a new tab for better ad interaction. After closing, the movie will open automatically.
      </div>
    </div>
  </div>

  <script>
    (function(){
      const playBtn = document.getElementById('playBtn');
      const overlay = document.getElementById('interstitial');
      const closeBtn = document.getElementById('closeAd');
      const openAdTab = document.getElementById('openAdTab');
      const countdownSpan = document.getElementById('countdown');

      // Your Google Drive movie link (replace if needed)
      const movieUrl = 'https://drive.google.com/file/d/1MFADDsjWFhEUqimdnv2RXbQTSQChP89q/view?usp=drivesdk';

      // config
      const minAdDisplaySeconds = 5; // time before close enabled
      const maxAutoFallbackSeconds = 20; // fallback to enable closing if ad doesn't load

      // show overlay when user clicks Play
      playBtn.addEventListener('click', function(){
        showOverlay();
      });

      function showOverlay(){
        overlay.classList.add('show');
        overlay.setAttribute('aria-hidden', 'false');
        startCountdown(minAdDisplaySeconds);
      }

      // Countdown visual and enabling close button
      let countdownTimer = null;
      function startCountdown(seconds){
        let remaining = seconds;
        countdownSpan.textContent = remaining;
        closeBtn.disabled = true;

        if (countdownTimer) clearInterval(countdownTimer);
        countdownTimer = setInterval(() => {
          remaining--;
          countdownSpan.textContent = remaining;
          if (remaining <= 0) {
            clearInterval(countdownTimer);
            countdownSpan.textContent = '0';
            closeBtn.disabled = false;
          }
        }, 1000);

        // Ensure close becomes enabled in case ad script delays: enable after max fallback
        setTimeout(() => {
          closeBtn.disabled = false;
          countdownSpan.textContent = '0';
        }, maxAutoFallbackSeconds * 1000);
      }

      // Close handler: hide overlay and open movie
      closeBtn.addEventListener('click', function(){
        overlay.classList.remove('show');
        overlay.setAttribute('aria-hidden', 'true');
        // Open movie in same tab (you can change to _blank if you prefer new tab)
        window.location.href = movieUrl;
      });

      // Optional: open the ad in a new tab (user action) — good for mobile ad interactions
      openAdTab.addEventListener('click', function(){
        // Open a new tab to the ad provider landing page location.
        // NOTE: We don't have a guaranteed landing URL from the ad script. For user action, open a generic ad provider domain or a tracking URL if provided by your ad partner.
        // Here we attempt to open the ad container's link if present, else open the ad network home.
        try {
          // Try to find <a> inside ad container (common if ad script injected a clickable element)
          const adFrame = document.getElementById('container-03a29260fe0435d3922b726bb7da0b06');
          const anchor = adFrame ? adFrame.querySelector('a') : null;
          if (anchor && anchor.href) {
            window.open(anchor.href, '_blank');
          } else {
            // fallback: open ad network domain (replace if you have a final landing/tracking URL)
            window.open('https://adsterra.com', '_blank');
          }
        } catch(e){
          window.open('https://adsterra.com', '_blank');
        }
      });

      // Accessibility: close overlay with Escape when allowed
      document.addEventListener('keydown', function(e){
        if (e.key === 'Escape' && !closeBtn.disabled && overlay.classList.contains('show')) {
          closeBtn.click();
        }
      });

      // Optional safety: if user closes the page or navigates away, nothing else to do.
    })();
  </script>

</body>
</html>
